<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>戸畑共立病院ダッシュボード</title>
    <link rel="stylesheet" href="style.css">

    <!-- Tailwind CSS (v3) をCDN経由で読み込みます -->
    <!-- Tailwind CSSはCSSを体系立てて書くための、ルールをまとめた仕組みです -->
    <!-- AIによるコード生成との相性を良くするため、Tailwind CSSを使用します -->
    <!-- tailwindcssのユーティリティークラスは「.tw-*」のプレフィックスを付けて呼び出します -->
    <!-- また今回はCSSから→TailwindCSSへのリフトアンドシフトを行う都合上、初期段階でベーススタイルを無効化します -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            prefix: 'tw-',
            corePlugins: {
                preflight: false,
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <header>
        <div class="header-container">
            <div class="header-container">
                <div class="header-left">
                    <h1 class="left-align">戸畑共立病院<br>ダッシュボード</h1><br>
                    <div class="date-display" id="latest-date">2025年2月17日(月) <br><span
                            class="update-time">更新時刻：00:00</span></div>
                </div>
                <div class="header-cards">
                    <div class="card header-card" id="suiyokai-card">
                        <h3>『水曜会 Top Down!』</h3>
                    </div>
                    <div class="card header-card" id="keiei-card">
                        <h3>『お知らせ』</h3>
                    </div>
                </div>
            </div>
    </header>


    <div class="dashboard">
        <div class="card">
            <h3>病床利用率</h3><strong>--%</strong>
        </div>
        <div class="card">
            <h3>救急車搬入</h3><strong>--台</strong>
        </div>
        <div class="card">
            <h3>入院患者</h3><strong>--人</strong>
        </div>
        <div class="card">
            <h3>退院予定</h3><strong>--人</strong>
        </div>
        <div class="card">
            <h3>一般病棟在院数</h3><strong>--/218 床</strong>
        </div>
        <div class="card">
            <h3>集中治療室在院数</h3><strong>--/16 床</strong>
        </div>
        <div class="card">
            <h3>平均在院日数</h3><strong>--日</strong>
        </div>
        <div class="card" id="surgery-register-card"
            onclick="openExternalLink('https://docs.google.com/spreadsheets/d/1CHU8Cgxgg5IvL3nB6ackAdqxe7-CNkmWDvtYE-keuXI/edit')">
            <h3>手術台帳</h3><strong>クリックして表示</strong>
        </div>
        <div class="card" id="duty-management-card"
            onclick="openExternalLink('https://docs.google.com/spreadsheets/d/1EX0t4wpSJZkEkhZ38PUGIyZVMOeGOTNdy2OI3rb_CTc/edit')">
            <h3>当直管理表</h3><strong>クリックして表示</strong>
        </div>
        <div class="card" id="covid-status-card"
            onclick="openExternalLink('https://docs.google.com/spreadsheets/d/1pgLCwJPxPpGO_-ro_J78QYqLzjrGHgTBKHL3ngybBbY/edit?gid=0#gid=0')">
            <h3>新型コロナ感染状況</h3><strong>クリックして表示</strong>
        </div>
        <!-- 「『空床マップ」の文字列を囲む h3 タグが正しく開始されていません -->
        <!-- ✅ 新しく追加するメディサイナスカード -->
        <div class="card" id="new-card"
            onclick="openExternalLink('https://docs.google.com/spreadsheets/d/16G6LfsDQSD_ogAPDSj6cL4LpVGWFsZxnhdp_GfZA7e8/preview?rm=minimal')">
            <strong><h3>『空床マップ』<br></h3><strong>クリックして表示</strong>
        </div>
    </div>

    <div class="charts-grid">
        <canvas id="bedChart"></canvas>
        <canvas id="ambulanceChart"></canvas>
        <canvas id="inpatientsChart"></canvas>
        <canvas id="dischargesChart"></canvas>
        <canvas id="generalWardChart"></canvas>
        <canvas id="icuChart"></canvas>

        <canvas id="averageStayChart"></canvas>

    </div>

    <script src="script.js"></script>

    <!-- 外部スクリプトの起点（エントリーポイント）はなるべく1つにまとめるのが上策です。 script.jsに集約しましょう。-->
    <script>

        // カードをクリックして新しく開く部分のコードは、URL以外は定義の変わらないコートです
        // script.js内にopenExternalLink()を記述しました。
        // イベントハンドラはDOM（id要素を示すセレクタ）からだけでなく、HTML属性内に記述することができます
        // clickイベントの場合はhtml要素のonclick属性としてJavaScriptの式を呼び出すことができます。
        // コードリファクタリングの観点から、今回はhtml要素のonClick属性を使うほうがスマートでしょう。

        // document.getElementById('surgery-register-card').addEventListener('click', function() {
        //     window.open('https://docs.google.com/spreadsheets/d/1CHU8Cgxgg5IvL3nB6ackAdqxe7-CNkmWDvtYE-keuXI/edit', '_blank');
        // });

        // document.getElementById('duty-management-card').addEventListener('click', function() {
        //     window.open('https://docs.google.com/spreadsheets/d/1EX0t4wpSJZkEkhZ38PUGIyZVMOeGOTNdy2OI3rb_CTc/edit', '_blank');
        // });

        // document.getElementById('covid-status-card').addEventListener('click', function() {
        //     window.open('https://docs.google.com/spreadsheets/d/1pgLCwJPxPpGO_-ro_J78QYqLzjrGHgTBKHL3ngybBbY/edit?gid=0#gid=0'); // ここに「新型コロナ感染状況」のスプレッドシートURLを入力
        // });

        // グラフの再表示
        // script.js内でもfetchData()を呼び出しており、二重呼び出しとなっています。index.html側の呼び出しを削除してください。
        // 影響：①データ取得による不要なAPIリクエスト、②グラフの二重描画、③パフォーマンスの低下
        // fetchData();
    </script>

</body>

</html>